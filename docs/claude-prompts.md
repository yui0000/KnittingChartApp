# Claude Code プロンプト集（KnitReader）

このプロジェクトで Claude Code に依頼する際の **標準プロンプト** です。  

**出力形式のルールを最優先**で守るように指示してください。

---

## ✅ 共通コンテキスト（初回に貼る）
> あなたはiOSエンジニアのペアプロ相手です。VS Code + Claude Code で、SwiftUI（iOS 17+）の編み図読み取りアプリを段階的に実装します。  
> 技術：SwiftUI + PDFKit + UIScrollViewブリッジ + PencilKit + SwiftData。アーキテクチャは MVVM + Clean。  
> 座標は**ドキュメント座標系**で保持し、描画時に投影します。  
> 以降、**差分パッチ**（変更ファイル一覧 / ファイル全文 / 実行手順 / 注意点）の形式で出力してください。  
> 破壊的変更や大量削除は提案しないでください。テスト容易性・責務分離・座標変換の一貫性・独立Undoを重視します。

---

## 1) リポジトリ初期化 & MVP骨組み
```
【タスク】最小雛形を生成してください。

要件：
- 構成: /App/{Domain,Data,UI,Kit}, /Resources, /Tests

- 画像MVP：ズーム/パン + 行マーカー（ダミー） + ＋操作（メモリ） + 独立Undo（暫定）
- SwiftDataモデル（DocumentProgress）の定義（永続化呼び出しは未）
- 座標：ドキュメント座標で保持、表示時に投影
- ビルド/実行手順、VS Code tips（任意）

出力形式：差分パッチ / 実行手順 / 注意点
```

## 2) PDFKit/画像 両対応 & 座標変換共通化
```
【タスク】座標変換ユーティリティを導入し、PDF/画像のオーバーレイ追従を統一実装。

要件：
- Document<->View 変換の共通ユーティリティ（往復テスト付）
- UIScrollView + UIHostingController(Overlay)
- PDFView ブリッジ（PDFページ bounds を参照）
- ズーム/パン時に変換を適用、ズレを解消

出力：差分パッチ / 設計説明 / 落とし穴と回避
```

## 3) 行設定UI・＋アクション・独立Undoの本実装
```
【タスク】始点Y・行幅・stepの設定UI、＋でマーカー/☑/カウント更新、独立Undo。

要件：
- 3種のUndoを独立スタック or UndoManagerで管理
- テスト：順序を変えたUndoシナリオ

出力：差分パッチ / 動作確認手順 / ログ方針
```

## 4) PencilKit 手書きメモ（保存/復元）
```
【タスク】PKCanvasViewオーバーレイ、dataRepresentation()保存、復元、クリア機能。

要件：
- ツールピッカー表示、ヒットテスト順序
- iPad/iPhone最適化

出力：差分パッチ / 注意点
```

## 5) 記号辞書・検索・ピン留め（最大5）
```
【タスク】/Resources/symbols.json 設計、検索（かな/カナ/英語簡易正規化）、ピン留め。

要件：
- 重複不可、超過はFIFO
- UI：トップにピン、タップでHowToモーダル、直近閲覧は先頭

出力：差分パッチ / 正規化仕様 / テスト
```

## 6) 永続化（SwiftData）とドキュメント紐付け
```
【タスク】セキュアブックマークと1:1紐付け、AutoSave、クラッシュ耐性。

出力：差分パッチ / モデル設計根拠 / 検証手順
```

## 7) UX改善・アクセシビリティ
```
【タスク】色弱対応、入力バリデーション、エラー処理、VoiceOver、ショートカット。

出力：差分パッチ / ヘルプビュー
```

## 8) バグ報告テンプレ
```
【バグ報告】
症状：◯◯
再現手順：1) … 2) … 3) …
期待：◯◯
環境：iOS/端末/Build SHA
お願い：診断観点とパッチ、往復変換テスト更新
```

## 9) コードレビュー依頼テンプレ
```
【レビュー依頼】対象ディレクトリ / 観点（座標一貫性・Undo独立性・SwiftData競合・命名）
お願い：修正パッチと根拠、代替案
```

## 10) ビルド/実行タスクの生成依頼
```
【タスク】.vscode/tasks.json と Makefile を生成。build/run/test/archive。変数化。使い方も。
```

## 11) Fastlane（任意）
```
【タスク】TestFlight最小構成（gym→pilot）。.envのダミー例とトラブルシュート。
```

---

### ✅ 出力フォーマット（毎回末尾に付けてもらう）
- 変更ファイル一覧（相対パス）
- 各ファイルの完全な内容
- 実行/テスト手順
- 注意点・制限
